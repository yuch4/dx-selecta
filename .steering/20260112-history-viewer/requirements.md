# 要求内容

## 概要

過去に実施した診断・比較資料・稟議書の閲覧機能と、途中で保存して再開できる機能を実装する。

## 背景

ユーザーは以下のケースで過去データにアクセスしたい：
- 過去に作成した稟議書を参照・再利用したい
- 途中まで進めた診断を後日再開したい
- 以前の比較結果を確認したい
- 類似案件の参考として過去の診断内容を見たい

現状は稟議書の履歴のみ簡易表示されているが、診断・比較の履歴閲覧や、途中保存からの再開機能が不足している。

## 実装対象の機能

### 1. 履歴一覧ページ（History）
- 過去の診断セッション、比較、稟議書を一元管理するページ
- フィルター機能（ステータス、カテゴリ、期間）
- 各項目へのクイックアクセス

### 2. 診断セッションの途中保存・再開
- in_progress状態のセッションを一覧表示
- 任意のステップから再開できるナビゲーション
- 現在のステップを保存して後で再開

### 3. 履歴詳細ビュー
- 診断入力内容の確認
- 検索結果・比較マトリクスの参照
- 稟議書の閲覧・再編集

## 受け入れ条件

### 履歴一覧ページ
- [ ] `/dashboard/history` で履歴一覧を表示できる
- [ ] 診断セッション、比較、稟議書を統合して時系列で表示
- [ ] ステータス（in_progress / completed / archived）でフィルターできる
- [ ] カテゴリでフィルターできる
- [ ] 期間でフィルターできる
- [ ] 各項目から詳細ページへ遷移できる

### 途中保存・再開
- [ ] in_progress状態のセッションが「作業中」として表示される
- [ ] 「再開」ボタンで診断フォームの続きから開始できる
- [ ] 現在の進捗（どのステップまで入力済みか）が表示される

### 履歴詳細ビュー
- [ ] 診断入力内容を読み取り専用で確認できる
- [ ] 検索結果（スコア・Explain）を確認できる
- [ ] 比較マトリクスを確認できる
- [ ] 稟議書Markdownを確認できる
- [ ] completedセッションから条件を変えて再診断できる

### サイドバー
- [ ] サイドバーに「履歴」メニューを追加

## 成功指標

- 履歴ページ表示まで2秒以内
- 再開操作から診断フォーム表示まで1秒以内

## スコープ外

- 履歴の削除機能（将来実装）
- 履歴の共有機能（将来実装）
- 履歴の検索機能（将来実装）

## 参照ドキュメント

- `docs/product-requirements.md` - PRD: 4. 稟議1枚生成 > 生成履歴が保存される
- `docs/functional-design.md` - データモデル: DiagnosisSession, SearchRun, ProposalOutput
- `docs/architecture.md` - レイヤー構造
