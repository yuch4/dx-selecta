# タスクリスト

## 🚨 タスク完全完了の原則

**このファイルの全タスクが完了するまで作業を継続すること**

---

## フェーズ1: 環境確認

- [x] 1.1 Supabaseプロジェクト接続確認
  - [x] Supabase MCP Serverでプロジェクト情報を取得
  - [x] 現在のテーブル状態を確認（空）

## フェーズ2: マイグレーション適用

- [x] 2.1 usersテーブル作成
  - [x] テーブル作成
  - [x] RLSポリシー設定
  - [x] 新規ユーザー作成トリガー

- [x] 2.2 tenantsテーブル作成
  - [x] テーブル作成
  - [x] RLSポリシー設定

- [x] 2.3 tenant_membersテーブル作成
  - [x] テーブル作成
  - [x] RLSポリシー設定

- [x] 2.4 ヘルパー関数・RLSポリシー追加
  - [x] tenants/tenant_membersのRLSポリシー
  - [x] create_tenant_with_owner関数
  - [x] updated_atトリガー

## フェーズ3: 確認・テスト

- [x] 3.1 マイグレーション結果確認
  - [x] テーブル一覧を確認（users, tenants, tenant_members）
  - [x] RLSポリシー確認（全テーブルRLS有効）

- [x] 3.2 ローカル動作確認
  - [x] npm run dev で起動
  - [x] ログインページ表示確認

---

## 実装後の振り返り

### 実装完了日
2026-01-11

### 計画と実績の差分

**計画と異なった点**:
- マイグレーションを1つの大きなSQLではなく、5つの小さなマイグレーションに分割して適用（MCP Serverでの管理しやすさ向上）

### 学んだこと

**技術的な学び**:
- Supabase MCP Serverの `apply_migration` を使うと、マイグレーション履歴が自動的に管理される
- RLSポリシーは複数のマイグレーションに分けて適用可能
- Next.js 16のmiddleware非推奨警告は動作には影響しない
